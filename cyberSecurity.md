tripwires
[sabsa](https://www.stationx.net/sabsa/)
exploit kits - [data base](https://www.exploit-db.com/search?q=)
[governments](https://www.eff.org/files/2014/01/06/20131230-appelbaum-nsa_ant_catalog.pdf) 
[ARP spoofing](https://www.irongeek.com/i.php?page=security/AQuickIntrotoSniffers) -[ ARP watch](https://www.tecmint.com/monitor-ethernet-activity-in-linux/)/ [sniffer detection](https://sniffdet.sourceforge.net/)
man in the middle?

ethical hacking/penetration testing!!!
# ה - vulnerability landscape
## נכס
### פרטיות
כאשר לא רואים מה המשתמש עושה/במצא, אבל יודעים מי זה המשתמש.
### אנונימיות
כאשר לא יודעים מי המשתמש, אבל רואים מה המשתמש הזה עושה/מבצא. כך שהזהות של המשתמש נשארת לא ידוע.
##### שם בדוי
שימוש של שם לא אמיתי, שיכול לקשר לשם האמיתי.
## בטיחות
הבטיחות זהו גורם להגנה על ההסכמות, על ידי מימוש בקרות אבטחה(VPN, הצפנה, ועוד...). בקרות ההאבטחה נברחים לפי סוג האיומים והאוייבים, ודורשים הפעיל יחסי ביטיחות.
יחסי ביטיחות נקבעים לפי מספר דברים:
- [ה - CIA]( https://www.techtarget.com/whatis/definition/Confidentiality-integrity-and-availability-CIA)
סודיות - מונע מידע מהנכס מניסיונות גישה לא מורשים.
יושר - השינויים בנכס מאנשים ללא גישה.
זמינות - איזה מידע מהנכס קריאה מקבוצות בעלי גישה.
- [ה - Pinkerian Hexed]( https://en.wikipedia.org/wiki/Parkerian_Hexad)
רשות(שליטה) - אובדן/החזקת שליטה ללא פגיעה בסודיות.
אותנטיות(אמיתות/הוגנות) - אמיתות.
תועלת - תועלת המידע שנלקח, העד כמה הוא מזיק למשתמש שנקח ממנו ותורם למי שלקח אותו.
- אחר
[אי דחיה](https://en.wikipedia.org/wiki/Non-repudiation) - יכולת מניעת שליחת הודעות משולח.
[אימות](https://en.wikipedia.org/wiki/Authentication)- אימות משתמש למערכת.
[והרשאה](https://en.wikipedia.org/wiki/Authorization) - פירות ההרשאות זכויות של משתמש לנכס.
#### הגנה עמוקה
ליצור מספר שכבות הגנה, שכאשר שכבה נפרצה אחרת ממשיכה להגן על הנכסים.
יש שלוש סוגי הגנה:
- מניעה
להצפין את הקבצים(המפתח לא זמין).
- זיהוי
הקמה של מלכודת(canary), שיתריע כאשר נכנסים למערכת.
- שחזור
## איומים
דברים שיכולים לקראות(malware, ועוד…). שינסו לחדור דרך הבטיחות דרך נקודות פגיעות(bugים). האיומים שהמשתמש פוגש בהם נקראים thread landscape/model.
## אוייבים
האוייבים מפעילים את האיומים.
![[The+Cyber+Security+Landscape+Diagram.jpg]]
### ה - malware
אלו תוכניות זדוניות.
[דוגמה](https://www.bbc.com/news/technology-32704043)
[עוד דברים](https://www.sophos.com/en-us/en-us/medialibrary/PDFs/technical-papers/malware-forecast-2018.pdf?la=en)
סוגי malware
- ה - macro virus
וירוס שנכתב בשפת macro(VBS), שלרוב נרצים באפליקציות שמריצות אוטומטי scriptים בשפות ה - macro.
- ה - stealth virus
ווירוס שמחביא את השינויים שהוא עשה, מנסה לבטל תוכנות אנטי ווירוס על ידי מניעת הבקשה למערכת ההפעלה, ומספק מידע שגוי
- ה - polymorphic virus
מספק מגוון עותקים שונים של הפעולות של עצמו.
- ה - self-garbling virus
מסנה להתחבא מהאנטי ווירוס בעל ידי שינוי הקוד של עצמו שלא מתאים חתימות אנטי ווירוסים.
- ה - bots & zombies
אוסף של מכשירי פריצה שפועלים לפי פקודות האקר.
- תועלים
ווירוסים שעוברים ממכשיר אחד לשני.
- ה - OS rootkit
משובצים ל - kernel של מערכת ההפעלה, מה שמאפשר לו להחביא את קיומו לגמרי ממערכת ההפעלה. 
- ה - firmware rootkit
בתוך השבב של ה - firmware, תיהיה התוכנה של ה - malware. 
- ה - key loggers
עם מתחברים לקשות המקשים
- סוס טרויאני
תוכנות שמתחזות כדבר אחד אבל הן באמת malware, 
##### ה - remote access tools([RAT](https://www.darkreading.com/perimeter/the-7-most-common-rats-in-use-today))
תוכנות שרצות על המערכת ומאפשרות לפולשים לגשת למערכת שלך מרחוק.
קשה להבחין ב - RATים בגלל מספר סיבות, הם פותחים portים חוקיים ברשת במכשיר שהוזרק, או דרך פרסום חוקי באתרים ומצבאים פעולות שלא דומות ל - malware.
ה - RATים הנפוצים:
-  ה - Sakula
מתנהג כמו תוכנית עם כוונות טובות, ומספק לתוקף שליטה כ - administrator.
מאתחל בקשת HTTP כאשר מתקשר עם שרת פקודות ושליטה, ושולח את ה - hash לשרת במקום את הסיסמה כטקסט.
- ה - KjW0rm
כתוב ב - VBS, מה שמקשה על ההיבחון. הטרויאן יוצר backdoor שמאפשר לתוקף לקחת שליטה על המכשיר.
- ה - Havex
תוקף מערכות בקרה עצמאיות, מאשר לתוקף גישה מלאה על המכשיר, שולח ל C&C דרך HTTP/HTTPS ובקושי משאיר ראיות שהיה במכשיר.
- ה - dark comet
מאפשר יכולת ניהול מקיף, משתמש ב - crypterים בשביל להחביא את קיומו מהאנטי ווירוס, ומבצא מספר משימות(ביטול ה - task manager, ה - firewall ועוד…).
- ה - Heseber BOT
פורס מחשוב רשת וירטואלית(VNC) כחלק מהפעולה, ובגלל ש - VNC כלי חוקי קשה להבחין בו. ומשתמש ב - VNC להעביר קבצים ולספק שליטה במכשיר. 
##### ה - ransomware
כאשר ה - malware לוקח שליטה על המכשיר, ומצפין את כל הקבצים האישיים שרק האקר יודע את צופן ההצפנה.  לאחר ההצפנה תישלח הודעה למכשיר שנפרץ ולרוב מבקש כסף בתמורה.
- ה - malvertisement
פרסום ברשת שמזוהם עם ווירוס, הפרסומות מכילים שרשרת של scriptים שמצביעים ל - scriptים אחרים שמורידים scriptים אחרים וכך עד שעבורים את בדיקות הבטיחות.
- ה - drive by attack
כאשר משתמש מבקר באתר רשת בעל קוד שמנצל את המכשיר שלך.
- ה - spyware
הוסף מידע ושולח אותו בחזרה לאקר. ומבלי לגרום לנזק ישירות.
- ה - adware
תוכנה לא רצוייה כופיה פירסום על המשתמש.
- ה - browser hijacking
כאשר adware/malware לוקח את השליטה בדפדפן.
- ה - scareware
סוג מתקפת הנדסה סוציאלית, שגורם למשתמש להאמין באיום שלא קיים. ולרוב יגרמו למשתמש לשלם בשביל להתקן את ה - malware.
- ה - potentially unwanted programs(PUPs)
### ה - phishing
מתקפה שמנסה לגרום למשתמש ללחוץ על קישור שיגרום להרצה של תוכנית malware.
דרכי מתקפות:
מניפולצית קישור
שימוש בקישור זדוני וגרימה שהוא מזוייף, לרוב דרך שימוש של subdomain או domain שנרשמו לא נכון(goo1e).
כישור יכול גם לקחת את המשתמש לאתר אמיתי, אבל כאשר הוא מכניס פרטים, הקישור גם יפעיל script שיקח את הפרטים הנתונים.
יש גרסאות שונות של phishing, שנסים לתקוף דרך שיטות שונות:
- ה - vishing
זהו קול phishing, 
- ה - SMSing
הודעות phishing.
### מתקפות הנדסה סוציאלית
מתקפות שמתרכזות על חולשות האדם.
### ה - CPU hijackers
זהו תוכנית malware שחוטפת את מחזורי המעבד(CPU) בשביל לכרות cryptocurrency. מה שגרם לפיתוח של crypto miner. כריתה זה אימות עסקות שמקבלים בחזרה cryptocurrency. 
#### ה - java-script 
יכול להיות מוזרק באתר על ידי הבעלים של האתר או threat actor. יכול להיות כאשר נלקחה השליטה מהאתר על ידי פרסומת.
ל - mitigate:
צריך לראות את ה - CPU usage, ולבדוק האם יש תהליכים שרצים גבוההים מידי.
#### ה - darknet
ה - darknet זה רשת שכבת על מוצפנת, שאפשר לגשת רק עם תוכניות/הרשאות מסויימות.
### ה - backdoor
ה - backdoor זה חולשה של המערכת. [דוגמאות ל - backdoorים](https://www.gnu.org/proprietary/proprietary-back-doors.en.html)
כאשר משהו הוא close source הדרך היחידה למצוא backdoorים זה על ידי reverse engineering. במקרים של close source צריך לסמוך על מתכנת.
ולכן במקרים של open source יש סיכוי קטן יותר ל - backdoorים וגם בגלל שהקוד פתוח לביקורת הציבור.
אפשר להקל מפני backdoorים בעזרת בנייה דטרמיניסטית שניתנים לשחזור שמאפשר להבחין ב - backdoorים.
מבנה [שניתן לשחזר ](https://media.ccc.de/v/camp2015-6657-how_to_make_your_software_build_reproducibly)זהו סט של שיטות פיתוח תוכנות שיוצרים path מאומת, בין קוד מקרום שקריא לקוד בינארי.
במבנה [דטרמיניסטי](https://blog.torproject.org/deterministic-builds-part-one-cyberwar-and-global-compromise/) מספר רב של קבוצות בונים מחדש בדרך עצמאי ובודקים שכולם מקבלים את אותן תוצאות.
# הצפנה
הצפנה זה שיטה לעברת מידע קריא(plain text), לצורה שהמידע לא קריא(cipher text) כך שהמידע נשמר פרטי.
## פענוח
פענוח זה שיטה לעברת מידע לא קריא(cipher text) למידע קריא(plain text).
להצפנה יש שני חלקים מרכזיים, האלגוריטם(ציבורי) ומפתח(פרטי).
המפתח משמש כמו סיסמא שרק בעזרתו אפשר לפענח, הסיסמא עוברת למפתח דרך פונקצית גזירה למפתח.
יש מספר דרכים לנסות לפענח בצפנה:
- ה - brute force
כאשר בונים אלגוריתם שינחש את כל קומבינציה קיימת.
- מתקפת dictionary
כאשר מנסים את כל המילים במילון נגד המפתח, אבל כאשר המפתח לא מילה אז השיטה הזאת תכשל.
- שילוב
שילוב שתי השיטות ביחד.
### הצפנה סימטרית
אלגוריטם סימטרי זו שיטה שבה משתמשים בפתח אחד להצפין.
דוגמאות:
- ה - data encryption standard(DES)
- ה - triple-DES(3DES)
- ה - blowfish
- ה - RC4
- ה - RC5
- ה - RC6
- ה - advanced encryption standard(AES)
### הצפנה אי-סימטרית
אלגוריטם אי-סימטרי משתמש בשני מפתחות, כאשר מפתח אחד ציבורי ומפתח שני פרטי.
האלגוריתמים מאפשרים להחליף מפתחות או הסכמות, וגם מאפשרים digital signature.
כך שאפשר לשלוח את המפתח הפרטי בדרך בטוחה.
שתי המפתחות קשורים זה לזה בדרך מתמטית ונוצרים באותו הזמן.
ב<span style="color:rgb(143, 74, 196)">שיטה הזאת כאשר מפתח אחד משמש במפתח אחד להצפנת המידע, דרוש להשתמש במפתח השני בשביל לפענח את המידע.</span>
- דרך של 
כאשר השולח מצפין בעזרת המפתח הציבורי של המקבל, המידע יהיה פרטי(רק המקבל יכול לקרוא את המידע), אבל המקבל לא יכול לאמת(לדעת מי שלח את המידע).
- דרך של open message format:
כאשר מצפינים עם המפתח הפרטי של השולח המידע יהיה מאומת(ידוע ממי נשלח), אבל כל אחד בעל העתק למפתח הציבורי יכול לפענח את המידע.
דוגמאות:
- ה - Rivest Shamir Adleman(RSA)
הבטיחות באה מהקושי של פירוק לגורמיים של מספרים גדולים בחזרה למספרים ראשוניים.
- ה - Elliptic curve cryptosystem(ECC)
הבטיחות באה מאלגוריתם חישוב דיסקרטי לעיקום אליפטי.
- ה - Diffie Hellman(DH)
הבטיחות בה מהאלגוריתם לחישוב דיסקרטי בשדה סופי.
- ה - EL Gamal
הבטיחות בה מהאלגוריתם לחישוב דיסקרטי גם בשדה סופי.
##### מערכת crypto
כאשר יש שילוב של שיטות שיכולות להשתלב, ומספק למשתמש מספר שירותי ביטחון(פרטיות, אימות, אי דחיה ויושר).
דוגמאות; PGP, bit locker, true crypt, TLS, ועוד…
### סימטרי ואי-סימטרי
הצפנה סימטרית, חזקה ומהירה אבל בלי יכולת איזון.
הצפנה אי-סימטרית, הפצת מפתחות, יכולת איזון, אימות ואי דחיה, אבל איטי(אורך bit גדול) וקשה לחישוב מתמטי.
ולכן יש שילוב בין שתי השיטות, מפתח ציבורי ופרטי משומשים להחלפה והסכמה של מפתחות, ואלגוריתמם סימטרים משומשים להצפנה של המידע עצמו.
לדוגמה: HTTPS משתמש ב - TLS ו - SSL.
### אימות
בשביל לאמת שהמפתח שנשלח באמת המפתח האמיתי מהשולח משתמשים באלגוריתמים שונים
#### פונקציות hash
פונקצית hash לוקח כ - input מידע בכל גודל, וממיר את המידע לפי פונקצית ה - hash למחרוזת תווים בגודל קבוע.
ב<span style="color:rgb(143, 74, 196)">פונקצית hash אי אפשר להמיר בחזרה את המחרוזת המעובד, כך שזה מספק יושרה והבחנה בשינויים.</span>
שימושים:
שמירת סיסמאות כ - hash במאגר מידע.
להכיל סוד שהוגדר בעבר להודעה, ואז לעשות hash להודעה(HMAC), בשביל לספק פרטיות ויושרה.
דוגמאות לפונקציות:
- ה - MD2, MD4, MD5
- ה - HAVAL
- ה - SHA, SHA-1, SHA-256, SHA-384, SHA-512
- ה - tiger
[דוגמה ל - hash](https://defuse.ca/truecrypt-7.1a-hashes.htm)
#### ה - digital signature
ה - digital signature זהו תוצאת התהליך של ערך ה - hash, כלומר זהו האורך הקבוע של תוצאת פונקציית ה - hash שהוצפן למפתחות הפרטי של השולח. שמספק את ה - digital signature/signed message. 
כלומר ה - digital signature זה חתימה של אישור. החתימה מסמן מספר דברים: 
אימות(הוצפן עם המפתח הפרטי), אי דחיה(המפתח הפרטי של השולח שומש), ישרה(בגלל תהליך ה - hashing).
בשביל לבדוק שה - digital signature תקין, צריך לבצא את התהליך הפוך, משתמשים במפתח הפרטי של השולח לפענח, דבר שמגלה את הערך ה - hash. 
כאשר האימות שגוי, ה - digital signature לא תקין תישלח הודעה.
### פרוטוקול ביטחון
בעזרת שימוש של כל השיטות של הצפנה שכבות הביטחון מאפשרות פרוטוקולי הצפנה. שמספקים ביטחון תקשורת דרך הרשת.
קישור לטבלות שמסבירות על הגרסאות של SSL והמימוש של [פרטיות](https://en.wikipedia.org/wiki/Transport_Layer_Security#Key_exchange_or_key_agreement), אימות [ויושרה](https://en.wikipedia.org/wiki/Transport_Layer_Security#Data_integrity).
שילוב האלגוריתם נקרה cypher suite, [רשימה של cypher suite](https://en.wikipedia.org/wiki/Transport_Layer_Security#Cipher).
#### ה - SSL
ה - SSL(security socket layer), גרסה ישנה יותר של TLS בעיקר בגלל שהשרתים של SSL היו צריכים עדכון.
#### ה - TLS
ה - TLS(transport layer security) הוא הפרוטוקול הכי משומש לעברת מידע מבוטח. שמספק פרטיות דרך הצפנה(סימטרית), אימות דרך זהוי באמצעות מפתח ציבורי, מסמכים ו - digital signature, יושרה דרך אימות הודעות(MAC) בתקשורת בין שתי אפליקציות שמונע איבוד הודעות.
יש אלגוריתמים מועדפים בגלל שהם משתמשים ב - Diffie-Hellman להחלפת מפתחות, מה מבטיח רכוש של פרטיות(forward secrecy), הרכוש הזה מבטיח שלא תיהיה פשרה של המפתחות גם עם השרת מתפשר, בעזרת יצירת פגישת מפתחות ייחודי לכל פגישה שהמשתמש מתחיל.
כאשר <span style="color:rgb(143, 74, 196)"> השרת מתפשר והמפתח הפרטי שלו מתפשר אז השיחות הקודמות לא יכולות להתפנעח.</span> 
##### ה - SSL stripping
כל תוקף שמציב את עצמו בין באמצע של המקור ליעד בזרימת מידע יכול לבצא מתקפת man in the middle. המתקפה נקראת SSL strip.
כאשר התוקף מתנהג כמחליט החלטות, ויכול לשנות את ההצפנה של חיבור HTTPS לחיבור HTTP. 
הגעה לאתר HTTPS אפשרית דרך מספר דרכים, כתיבת הכתובת של האתר ששולח את המשתמש ל - HTTP של האתר ואז מקבל הודעת שינוי כיוון 302 לגרסה של HTTPS של האתר.
דרך נוספת היא דרך שימוש קישור.
ה - SSL strip מתנהג כמחליט החלטות ומחפש מקרים של שני הדרכים, מייצג את החיבורים(מדמה) ושולח גירסה של HTTP.
דרכים לביצוא???

דרך למניעה מהלוקח היא הפשטת SSL זה בעזרת מנהרה מוצפנת, שמאפשר הצפנה מקצה לקצה, ושמשתמש במספר פרוטוקולים(SSH,VPN).
דרך מניעה השרת היא לאפשר HSTS, משתמש ב - header מיוחד לתגובה לגרום לדפדפן לקבל רק תנועת HTTPS, פועל רק כאשר הלוקח כבר היה באתר בעבר ומסכים רק לקבלת HTTPS.
### פרוטוקול HTTPS
מספק את השירות ביטחון של TLS; מידע מוצפן, אימות, ישירות הודעות.
כאשר ניגשים לאתר של HTTPS, שרת האינטרנט יתחיל להפעיל SSL ולהגן על התקשורת:
השרת שולח הודעה בחזרה ללקוח שמציין שמפגשים ביטיחותים צריכים לייסד. והלקוח בחזרה שולח פרמטרים של ביטחון(איזה אלגוריתמים להשתמש).
השרת מאמת את הלקוח על ידי שליחת digital certificate, אם הלקוח מחליט לבטוח בשרת אז התהליך ממשיך. 
הלקוח יוצר מפתח סימטרי ומצפין אותו עם המפתח הציבורי של השרת. ושניהם משתמשי במפתח הסימטרי להצפנת מידע.
##### ה - SNI
ה - [SNI](https://en.wikipedia.org/wiki/Server_Name_Indication)(server name indication) זה הרחבה ל - TLS שהלקוח מציין איזה host name מנסה להתחבר בהתחלת התהליך ה - handshake.
##### ה - digital certificate
זה שיטת אימות, ש - hashing ו - digital signature משתמשים.
משמש לבדיקה שהמפתח הפרטי הוא לגיטימי,  כאשר הם נחתמים דיגיטלי ויוצרים שרשרת של אמון. לרוב משתמשים ב - X.509, שזה מסמך דיגיטלי שמכיל מידע על הבעלים של ה - certificate.
###### הרשות אישורים
